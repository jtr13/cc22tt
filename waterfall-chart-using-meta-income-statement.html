<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 56 Waterfall chart using meta income statement | Community Contributions for EDAV Fall 2022 Tues/Thurs</title>
<meta name="description" content="Soheil Fakhrieh Kashan ## loading needed libraries library(waterfalls) library(ggplot2) library(scales) library(readxl) library(dplyr) library(knitr) library(plotly)  56.0.1 Why to use Waterfall...">
<meta name="generator" content="bookdown 0.30 with bs4_book()">
<meta property="og:title" content="Chapter 56 Waterfall chart using meta income statement | Community Contributions for EDAV Fall 2022 Tues/Thurs">
<meta property="og:type" content="book">
<meta property="og:description" content="Soheil Fakhrieh Kashan ## loading needed libraries library(waterfalls) library(ggplot2) library(scales) library(readxl) library(dplyr) library(knitr) library(plotly)  56.0.1 Why to use Waterfall...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 56 Waterfall chart using meta income statement | Community Contributions for EDAV Fall 2022 Tues/Thurs">
<meta name="twitter:description" content="Soheil Fakhrieh Kashan ## loading needed libraries library(waterfalls) library(ggplot2) library(scales) library(readxl) library(dplyr) library(knitr) library(plotly)  56.0.1 Why to use Waterfall...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="libs/visjs-7.4.9/vis-timeline-graph2d.min.css" rel="stylesheet">
<script src="libs/visjs-7.4.9/vis-timeline-graph2d.min.js"></script><link href="libs/timeline-0.4/timevis.css" rel="stylesheet">
<script src="libs/timevis-binding-2.1.0/timevis.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script src="libs/Dygraph.Plugins.Crosshair-1.0/crosshair.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.26/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Community Contributions for EDAV Fall 2022 Tues/Thurs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="r-window-functions-cheatsheet.html"><span class="header-section-number">6</span> R window functions cheatsheet</a></li>
<li><a class="" href="rmd-chunk-option-cheat-sheet.html"><span class="header-section-number">7</span> Rmd chunk option cheat sheet</a></li>
<li><a class="" href="helpful-ggplot2-extensions-cheatsheet.html"><span class="header-section-number">8</span> Helpful ggplot2 Extensions Cheatsheet</a></li>
<li><a class="" href="commonly-used-graph-cheatcheet.html"><span class="header-section-number">9</span> Commonly-used graph cheatcheet</a></li>
<li><a class="" href="git-and-version-control.html"><span class="header-section-number">10</span> Git and version control</a></li>
<li><a class="" href="useful-plots-for-bioinfomatics-in-r.html"><span class="header-section-number">11</span> Useful plots for Bioinfomatics in R</a></li>
<li><a class="" href="different-ways-to-create-world-map-in-r.html"><span class="header-section-number">12</span> Different ways to create world map in R</a></li>
<li><a class="" href="color-in-r-python-and-jshtmlcss.html"><span class="header-section-number">13</span> Color in R, Python, and JS/HTML/CSS</a></li>
<li><a class="" href="color-palettes-for-data-visualization.html"><span class="header-section-number">14</span> Color Palettes for Data Visualization</a></li>
<li><a class="" href="data-visualization-using-seaborn.html"><span class="header-section-number">15</span> Data visualization using Seaborn</a></li>
<li><a class="" href="machine-learning-cheatsheet-for-r-and-python.html"><span class="header-section-number">16</span> Machine Learning Cheatsheet for R and Python</a></li>
<li><a class="" href="data-visualization-with-r-ggplot2-vs.-matlab.html"><span class="header-section-number">17</span> Data Visualization with R ggplot2 vs. Matlab</a></li>
<li><a class="" href="ggplot2-plots-in-python-cheat-sheet-tutorial.html"><span class="header-section-number">18</span> Ggplot2 plots in python cheat sheet tutorial</a></li>
<li><a class="" href="model-evaluation-selection-visualization-with-easystats.html"><span class="header-section-number">19</span> Model evaluation, selection &amp; visualization with easystats</a></li>
<li><a class="" href="time-series-itsmr-cheat-sheet.html"><span class="header-section-number">20</span> Time Series: ITSMR Cheat Sheet</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="preprocessing-and-visualization-of-time-series-data.html"><span class="header-section-number">22</span> Preprocessing and Visualization of Time Series Data</a></li>
<li><a class="" href="how-to-use-sqldf.html"><span class="header-section-number">23</span> How to use sqldf</a></li>
<li><a class="" href="googlevis-in-r.html"><span class="header-section-number">24</span> googleVis in R</a></li>
<li><a class="" href="tutorial-for-vector-fields-in-r.html"><span class="header-section-number">25</span> Tutorial for vector fields in r</a></li>
<li><a class="" href="data-cleaning-with-r.html"><span class="header-section-number">26</span> Data cleaning with r</a></li>
<li><a class="" href="introduction-to-shiny-web-apps.html"><span class="header-section-number">27</span> Introduction to Shiny Web Apps</a></li>
<li><a class="" href="python-missingno-library-tutorial.html"><span class="header-section-number">28</span> Python missingno library tutorial</a></li>
<li><a class="" href="data-explorer-tutorial-and-automation.html"><span class="header-section-number">29</span> Data Explorer Tutorial and Automation</a></li>
<li><a class="" href="d-visualization-in-r.html"><span class="header-section-number">30</span> 3D Visualization in R</a></li>
<li><a class="" href="visualizing-time-series-data.html"><span class="header-section-number">31</span> Visualizing Time Series Data</a></li>
<li><a class="" href="igraph-in-r.html"><span class="header-section-number">32</span> igraph in r</a></li>
<li><a class="" href="geo-mapping-coordinate-extraction-using-api-calls.html"><span class="header-section-number">33</span> Geo-Mapping Coordinate Extraction Using API Calls</a></li>
<li><a class="" href="edav-garden.html"><span class="header-section-number">34</span> EDAV Garden</a></li>
<li><a class="" href="using-raster-data-in-r.html"><span class="header-section-number">35</span> Using raster data in R</a></li>
<li><a class="" href="make-geographical-maps-with-different-packages.html"><span class="header-section-number">36</span> Make Geographical Maps with Different Packages</a></li>
<li><a class="" href="how-to-obtain-data-from-api-and-process-raw-json-data.html"><span class="header-section-number">37</span> How to obtain data from API and process raw JSON data</a></li>
<li><a class="" href="sample-statistic-tutorial.html"><span class="header-section-number">38</span> Sample Statistic Tutorial</a></li>
<li><a class="" href="data-cleaning-tutorial.html"><span class="header-section-number">39</span> Data cleaning tutorial</a></li>
<li><a class="" href="mlr3-package-tutorial.html"><span class="header-section-number">40</span> mlr3 Package Tutorial</a></li>
<li><a class="" href="guide-to-nonparametric-tests.html"><span class="header-section-number">41</span> Guide to nonparametric tests</a></li>
<li><a class="" href="dplyr-pacakage-in-r.html"><span class="header-section-number">42</span> dplyr pacakage in R</a></li>
<li><a class="" href="how-not-to-visualize-american-elections.html"><span class="header-section-number">43</span> How (not) to visualize American elections</a></li>
<li><a class="" href="time-series-visualization-with-r.html"><span class="header-section-number">44</span> Time series visualization with R</a></li>
<li><a class="" href="twitter-textual-data-scraping-and-analyzing.html"><span class="header-section-number">45</span> Twitter textual data: scraping and analyzing</a></li>
<li><a class="" href="causal-inference-tutorial-a-quick-glance-at-interventional-treatment-and-simpsons-paradox.html"><span class="header-section-number">46</span> Causal Inference Tutorial: A Quick Glance at Interventional Treatment and Simpson’s Paradox</a></li>
<li><a class="" href="network-analysis-and-social-network-analysis.html"><span class="header-section-number">47</span> Network analysis and social network analysis</a></li>
<li><a class="" href="network-analysis-in-r.html"><span class="header-section-number">48</span> Network Analysis in R</a></li>
<li><a class="" href="interactive-3d-visualization-in-r.html"><span class="header-section-number">49</span> Interactive 3D Visualization in R</a></li>
<li><a class="" href="introduction-to-common-sampling-techniques-in-r.html"><span class="header-section-number">50</span> Introduction to common sampling techniques in r</a></li>
<li><a class="" href="machine-learning-in-r.html"><span class="header-section-number">51</span> Machine Learning in R</a></li>
<li><a class="" href="r-machine-learning-workflow-tutorial.html"><span class="header-section-number">52</span> R machine learning workflow tutorial</a></li>
<li><a class="" href="what-you-see-is-what-you-understand-learning-data-science-visually.html"><span class="header-section-number">53</span> What you see is what you understand: learning data science visually</a></li>
<li><a class="" href="is-the-data-visualization-misleading-or-not---survey.html"><span class="header-section-number">54</span> Is the data visualization misleading or not - Survey</a></li>
<li><a class="" href="animating-functions-and-histograms-in-python-using-matplotlib.html"><span class="header-section-number">55</span> Animating functions and histograms in python using matplotlib</a></li>
<li><a class="active" href="waterfall-chart-using-meta-income-statement.html"><span class="header-section-number">56</span> Waterfall chart using meta income statement</a></li>
<li class="book-part">Interview Prep</li>
<li><a class="" href="ten-interview-questions-and-answers.html"><span class="header-section-number">58</span> Ten interview questions and answers</a></li>
<li><a class="" href="data-science-internship-search-survival-guide.html"><span class="header-section-number">59</span> Data science internship search survival guide</a></li>
<li><a class="" href="data-visualization-interview-questions-sample.html"><span class="header-section-number">60</span> Data visualization interview questions sample</a></li>
<li><a class="" href="how-i-got-into-amazon-as-a-full-time-data-analyst.html"><span class="header-section-number">61</span> How I got into Amazon as a full time data analyst</a></li>
<li class="book-part">Case Studies</li>
<li><a class="" href="benford-case-study.html"><span class="header-section-number">63</span> Benford Case Study</a></li>
<li class="book-part">Blogs</li>
<li><a class="" href="equity-in-ai.html"><span class="header-section-number">65</span> Equity in AI</a></li>
<li><a class="" href="breaking-into-tech-black-girl-edition.html"><span class="header-section-number">66</span> Breaking into tech: black girl edition</a></li>
<li><a class="" href="homepage-artwork.html"><span class="header-section-number">67</span> Homepage Artwork</a></li>
<li><a class="" href="design-homepage-for-class-community.html"><span class="header-section-number">68</span> Design homepage for class community</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">69</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">70</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc22tt">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="waterfall-chart-using-meta-income-statement" class="section level1" number="56">
<h1>
<span class="header-section-number">56</span> Waterfall chart using meta income statement<a class="anchor" aria-label="anchor" href="#waterfall-chart-using-meta-income-statement"><i class="fas fa-link"></i></a>
</h1>
<p>Soheil Fakhrieh Kashan</p>
<div class="sourceCode" id="cb859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## loading needed libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hughparsonage/waterfalls">waterfalls</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span></code></pre></div>
<div id="why-to-use-waterfall-chart" class="section level3" number="56.0.1">
<h3>
<span class="header-section-number">56.0.1</span> Why to use Waterfall chart?<a class="anchor" aria-label="anchor" href="#why-to-use-waterfall-chart"><i class="fas fa-link"></i></a>
</h3>
<p>Waterfall chart is one of the most popular data visualizations in the Consulting and Finance presentations. The chart has a similar presentation as a bar chart but only highlights the positive or negative cumulative sequential impact variables. The purpose of a waterfall chart is mostly to explain how one number relates to another number through a series of variables or events. For example, we can effectively visualize how a company’s revenue is changed from one year to the next and what factors positively or negatively contributed to it.</p>
<div id="data-source" class="section level4" number="56.0.1.1">
<h4>
<span class="header-section-number">56.0.1.1</span> Data Source<a class="anchor" aria-label="anchor" href="#data-source"><i class="fas fa-link"></i></a>
</h4>
<p>In this short tutorial we will be exploring <strong>META</strong>’s quarterly income statement and use Waterfall charts to visualize their Q3 - 2022 financial statement.</p>
<p>META Quarterly Earnings reports: <a href="https://investor.fb.com/financials/default.aspx" class="uri">https://investor.fb.com/financials/default.aspx</a></p>
<p>#### Data prep</p>
<div class="sourceCode" id="cb860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## downlaod the Q3-2022 META's Income Statement from the above link</span></span>
<span><span class="co">## read the Excel file</span></span>
<span></span>
<span><span class="va">META_IS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'resources/waterfall_plot_meta_income_statement/Downloadable-PL-Q3-2022.xlsx'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## select relevant revenue lines for the waterfall chart</span></span>
<span><span class="va">META_summary</span> <span class="op">&lt;-</span> <span class="va">META_IS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">40</span>,<span class="fl">41</span>,<span class="fl">43</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## remove empty columns</span></span>
<span><span class="va">remove_na</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">META_summary</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">META_summary</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">remove_na</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## renaming variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">META_summary</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Breakdown'</span>,<span class="st">'Q3-2020'</span>, <span class="st">'Q4-2020'</span>, <span class="st">'Q1-2021'</span>, <span class="st">'Q2-2021'</span>,</span>
<span>                            <span class="st">'Q3-2021'</span>, <span class="st">'Q4-2021'</span>, <span class="st">'Q1-2022'</span>, <span class="st">'Q2-2022'</span>, <span class="st">'Q3-2022'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="waterfall-library" class="section level3" number="56.0.2">
<h3>
<span class="header-section-number">56.0.2</span> Waterfall library<a class="anchor" aria-label="anchor" href="#waterfall-library"><i class="fas fa-link"></i></a>
</h3>
<div id="meta-q3-2022-income-statement" class="section level4" number="56.0.2.1">
<h4>
<span class="header-section-number">56.0.2.1</span> META Q3-2022 Income Statement<a class="anchor" aria-label="anchor" href="#meta-q3-2022-income-statement"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>To use this library, the data frame must contain two columns. One with numeric values, and one with categorical variable showing the labels.</p></li>
<li><p>The order of the records on the label field will be the order on the graph. If that order is not desirable, you need to change the order of the records.</p></li>
</ul>
<div class="sourceCode" id="cb861"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For this cahrt we are going to use Q3-2022</span></span>
<span><span class="co"># Selecting the income statement breakdown and one quarter</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/waterfalls/man/waterfall.html">waterfall</a></span><span class="op">(</span><span class="va">META</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'META Q3-2022 Income Statement Waterfall'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'Income Breakdown'</span>, y<span class="op">=</span><span class="st">'$MM'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="waterfall_plot_meta_income_statement_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="improving-the-chart" class="section level4" number="56.0.2.2">
<h4>
<span class="header-section-number">56.0.2.2</span> Improving the chart<a class="anchor" aria-label="anchor" href="#improving-the-chart"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Add a total calculation to show the final summation: <code>calc_total = TRUE</code>
</li>
<li>Change the text size to make it larger: <code>rect_text_size = 1.5</code>
</li>
<li>Change the scale to show dollar: <code>scale_y_continuous(labels = dollar)</code>
</li>
</ul>
<div class="sourceCode" id="cb862"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 'META Q3-2021 Income Statement Waterfall chart</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/waterfalls/man/waterfall.html">waterfall</a></span><span class="op">(</span></span>
<span>  <span class="va">META_cond</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  rect_text_size <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  rect_text_labels_anchor <span class="op">=</span> <span class="st">"centre"</span>,</span>
<span>  calc_total <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  fill_by_sign <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  total_rect_color <span class="op">=</span><span class="st">'Dark Green'</span>,</span>
<span>  total_axis_text <span class="op">=</span><span class="st">'Income'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'META Q3-2021 Income Statement Waterfall'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'Income Breakdown'</span>, y<span class="op">=</span><span class="st">'$MM'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">dollar</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="waterfall_plot_meta_income_statement_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="how-year-over-year-quarterly-income-changed" class="section level4" number="56.0.2.3">
<h4>
<span class="header-section-number">56.0.2.3</span> How year-over-year quarterly income changed?<a class="anchor" aria-label="anchor" href="#how-year-over-year-quarterly-income-changed"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Create two new records. One for the Q3-2021 and one for Q3-2022.</li>
<li>For the income breakdown categories, calculate the delta between two periods</li>
</ul>
<div class="sourceCode" id="cb863"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">META_QoQ</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">breakdown</th>
<th align="right">Amount</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Income-Q3-2021</td>
<td align="right">10423</td>
</tr>
<tr class="even">
<td align="left">Advertising</td>
<td align="right">-1039</td>
</tr>
<tr class="odd">
<td align="left">Other revenue</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">Reality Labs</td>
<td align="right">-273</td>
</tr>
<tr class="odd">
<td align="left">Cost of revenue</td>
<td align="right">55</td>
</tr>
<tr class="even">
<td align="left">Research and development</td>
<td align="right">-2854</td>
</tr>
<tr class="odd">
<td align="left">Marketing and sales</td>
<td align="right">-226</td>
</tr>
<tr class="even">
<td align="left">General and administrative</td>
<td align="right">-438</td>
</tr>
<tr class="odd">
<td align="left">Income-Q3-2022</td>
<td align="right">5664</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb864"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># META Q3-2022 to Q4-2022 Income Waterfall chart</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/waterfalls/man/waterfall.html">waterfall</a></span><span class="op">(</span><span class="va">META_QoQ</span>,</span>
<span>          <span class="co"># changing the text size</span></span>
<span>          rect_text_size <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>          <span class="co"># selecting desired colors for each bar</span></span>
<span>          fill_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"seagreen"</span>, <span class="st">"orangered2"</span>, <span class="st">"seagreen"</span>, <span class="st">"orangered2"</span>,</span>
<span>                           <span class="st">"seagreen"</span>, <span class="st">"orangered2"</span>,<span class="st">"orangered2"</span>,<span class="st">"orangered2"</span>,</span>
<span>                           <span class="st">"seagreen"</span><span class="op">)</span>,</span>
<span>          <span class="co"># changing the default fill by sign so we can assign individual color          </span></span>
<span>          fill_by_sign <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'META Q3-2022 to Q4-2022 Income'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'Income Breakdown'</span>, y<span class="op">=</span><span class="st">'$MM'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">dollar</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="waterfall_plot_meta_income_statement_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>From the waterfall chart we can observe that Q3-2022 income is significantly lower
than the last year. This is a mainly driven by the increase in expenses in research and
development, and the decrease in revenue from advertising.</p>
<div id="using-plotly-to-create-simple-waterfall" class="section level5" number="56.0.2.3.1">
<h5>
<span class="header-section-number">56.0.2.3.1</span> Using plotly to create simple waterfall<a class="anchor" aria-label="anchor" href="#using-plotly-to-create-simple-waterfall"><i class="fas fa-link"></i></a>
</h5>
<p>Alternatively we can use plotly to create interactive waterfall charts.
<a href="https://plotly.com/r/waterfall-charts/" class="uri">https://plotly.com/r/waterfall-charts/</a></p>
<div class="sourceCode" id="cb865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span></span>
<span>  <span class="va">META_cond</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"waterfall"</span>,</span>
<span>  <span class="co">## list the breakdown. if the list is not specified. plotly order the categories alphabetically.</span></span>
<span>  x <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">'Advertising'</span>, <span class="st">'Reality Labs'</span>, <span class="st">'Other revenue'</span>,</span>
<span>            <span class="st">'Research and development'</span>, <span class="st">'Cost of revenue'</span>,</span>
<span>            <span class="st">'Marketing and sales'</span>, <span class="st">'General and administrative'</span><span class="op">)</span>, </span>
<span>  textposition <span class="op">=</span> <span class="st">"outside"</span>, y<span class="op">=</span> <span class="op">~</span><span class="va">META_cond</span><span class="op">$</span><span class="va">`Q3-2022`</span><span class="op">)</span> </span>
<span><span class="va">wf</span> <span class="op">&lt;-</span> <span class="va">wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"META Q3-2022 Income Statement Waterfall "</span>,</span>
<span>         xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Income Breakdown"</span><span class="op">)</span>,</span>
<span>         yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"$MM"</span><span class="op">)</span>,</span>
<span>         autosize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         showlegend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wf</span></span></code></pre></div>
<div id="htmlwidget-b2f34e65287272e1dd3b" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b2f34e65287272e1dd3b">{"x":{"visdat":{"268780116ba":["function () ","plotlyVisDat"]},"cur_data":"268780116ba","attrs":{"268780116ba":{"x":{},"textposition":"outside","y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"waterfall"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"META Q3-2022 Income Statement Waterfall ","xaxis":{"domain":[0,1],"automargin":true,"title":"Income Breakdown"},"yaxis":{"domain":[0,1],"automargin":true,"title":"$MM"},"autosize":true,"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Advertising","Reality Labs","Other revenue","Research and development","Cost of revenue","Marketing and sales","General and administrative"],"textposition":["outside","outside","outside","outside","outside","outside","outside"],"y":[27237,192,285,-5716,-9170,-3780,-3384],"type":"waterfall","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="animating-functions-and-histograms-in-python-using-matplotlib.html"><span class="header-section-number">55</span> Animating functions and histograms in python using matplotlib</a></div>
<div class="next"><a href="ten-interview-questions-and-answers.html"><span class="header-section-number">58</span> Ten interview questions and answers</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li>
<a class="nav-link" href="#waterfall-chart-using-meta-income-statement"><span class="header-section-number">56</span> Waterfall chart using meta income statement</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#why-to-use-waterfall-chart"><span class="header-section-number">56.0.1</span> Why to use Waterfall chart?</a></li>
<li><a class="nav-link" href="#waterfall-library"><span class="header-section-number">56.0.2</span> Waterfall library</a></li>
</ul>
</li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc22tt/blob/main/waterfall_plot_meta_income_statement.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc22tt/edit/main/waterfall_plot_meta_income_statement.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Community Contributions for EDAV Fall 2022 Tues/Thurs</strong>" was written by . It was last built on 2022-12-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
